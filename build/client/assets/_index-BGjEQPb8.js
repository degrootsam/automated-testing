import{j as t}from"./jsx-runtime-0DLF9kdB.js";import{c as N,a as V,r,L as z}from"./components-DAwjMhVV.js";import{a as D,b as T,c as G,d as x,e as I}from"./index-CokscfNF.js";import{d as O,a as B}from"./index-Cz_0cKVJ.js";import{G as $}from"./iconBase-ViZ73mvc.js";import{A as E}from"./index-D3e8Zo9y.js";import{C as R,B as C}from"./index-uFqOPUMb.js";import{H as W}from"./index-ZxjzPnyj.js";import{L as Z}from"./index-BAt5lQ6G.js";import{M as q}from"./index-BmP81L1w.js";import{P as J}from"./index-OLZrz1aE.js";import"./index-Cl9ayPRv.js";import"./index-CouqIJUX.js";import"./index-CwcO-kb-.js";import"./index-wfZIODoR.js";function K(c){return $({attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M10.8634 13.9195C10.6568 14.0195 10.4233 14.0246 10.2185 13.9444C10.1162 13.9044 10.021 13.843 9.93997 13.7614L4.81616 9.06268L2.58433 10.7656C2.37657 10.9241 2.08597 10.9111 1.89301 10.7347L1.17719 10.0802C0.941168 9.86437 0.940898 9.49112 1.17661 9.27496L3.11213 7.5L1.17661 5.72504C0.940898 5.50888 0.941168 5.13563 1.17719 4.91982L1.89301 4.2653C2.08597 4.08887 2.37657 4.07588 2.58433 4.2344L4.81616 5.93732L9.93997 1.23855C9.97037 1.20797 10.0028 1.18023 10.0368 1.15538C10.2748 0.981429 10.5922 0.949298 10.8634 1.08048L13.5399 2.37507C13.8212 2.5111 14 2.79721 14 3.11109V8H10.752V4.53356L6.86419 7.5L10.752 10.4664V8H14V11.8889C14 12.2028 13.8211 12.4889 13.5399 12.625L10.8634 13.9195Z"},child:[]}]})(c)}const me=()=>[{title:"Testing Suite Dashboard"},{name:"description",content:"Welcome to your personal testing suite!"}];function ue(){const c=N(),{projects:y,upstreamHasChanges:Q,message:p="",preferredTheme:b}=V(),[l,h]=r.useState(y),[n,d]=r.useState(c.state!=="idle"),w=async e=>{e.preventDefault(),await L()},L=async()=>{const e=await fetch("/projects/sync",{method:"POST"});if(e.ok)try{const{projects:s}=await e.json();h(s)}catch(s){console.error(s)}},m=()=>{j(e=>({...e,showModal:!1}))},[f,S]=r.useState(null),v=async e=>{i(!1),d(!0);const{name:s}=e,a=await fetch(`/projects/sync/${s}`,{method:"POST"});if(!a.ok){u(a.statusText),i(!0),d(!1);return}try{const{projects:o}=await a.json();h(o)}catch(o){i(!0);const F=o&&typeof o=="object"&&"message"in o?o.message:o;u(F),console.error(o)}d(!1)},P=async e=>{e.preventDefault();const{dataset:s}=e.currentTarget;if(!s.project)return;const a=l.find(o=>o.name===s.project);if(!a){i(!0),u(`${a} is not a valid project`);return}S(a),j({title:"Are you sure?",showModal:!0,onHideModal:m,buttons:[{children:"Confirm",color:"primary",onClick:g}]})},g=async e=>{e.preventDefault(),m(),f&&await v(f)},[k,j]=r.useState({showModal:!1,title:"",buttons:[{children:"Confirm",onClick:g,color:"primary"}],onHideModal:m}),[M,i]=r.useState(!!p),[A,u]=r.useState(p),H=e=>{e.preventDefault(),i(!1)};return t.jsxs(J,{title:"Welcome to your personal testing suite",preferredTheme:b,children:[t.jsx(q,{...k,children:"Please make sure you have saved your work before you continue."}),t.jsxs(R,{className:"max-w-xl w-full ",children:[t.jsx("div",{className:"mb-4",children:t.jsxs("div",{className:"flex flex-row justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-bold opacity-60 text-sm",children:"Suite name"}),t.jsx(W,{size:"h4",children:"bb-testing"})]}),t.jsx("div",{className:"flex flex-row gap-4"})]})}),M&&t.jsx("div",{className:"pb-4",children:t.jsx(E,{message:A,icon:D,color:"success",buttons:[{children:"Close",onClick:H}]})}),t.jsx(Z,{title:"Projects inside",button:t.jsxs("div",{className:"flex flex-row gap-2",children:[t.jsx(z,{to:"/projects/create","aria-disabled":n,children:t.jsxs(C,{size:"sm",loading:n,children:[t.jsx(B,{}),"Create project"]})}),t.jsxs(C,{size:"sm",onClick:w,disabled:l.length===0,loading:n,children:[t.jsx(x,{}),"Synchronize projects"]})]}),items:l.map(e=>{const s=[{"data-project":e.name,tooltip:"View in dashboard",href:`/projects/${e.name}/suites/view`,icon:T},{"data-project":e.name,icon:K,href:e.urls.vscode,tooltip:"Open in VSCode"}];e.git.initialized?s.push({"data-project":e.name,icon:O,href:e.urls.git,tooltip:"Open on GitHub"}):s.push({"data-project":e.name,icon:G,loading:n,href:"/projects/init",tooltip:"Initialize repository"}),e.git.remoteHasChanges||s.push({"data-project":e.name,icon:x,onClick:P,loading:n,tooltip:"Sync changes"});const a=e.git.remoteHasChanges?"primary":e.git.error?"error":"success",o=e.git.remoteHasChanges?"An update is available!":e.git.error?e.git.error:"Project is up-to-date";return{title:e.name,icon:I,buttons:s,status:{color:a,ariaLabel:o,animate:a==="error"?"ping":void 0}}})})]})]})}export{ue as default,me as meta};
