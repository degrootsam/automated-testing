import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{C as v,B as y}from"./index-uFqOPUMb.js";import{H as T}from"./index-ZxjzPnyj.js";import{L as N}from"./index-BAt5lQ6G.js";import{R as D}from"./run-test-BMbIBINN.js";import{r as o,b as C,d as R,a as k}from"./components-DAwjMhVV.js";import{f as E,g as b,h as A,i as B}from"./index-CokscfNF.js";import{A as w}from"./index-D3e8Zo9y.js";import{M as g}from"./index-BmP81L1w.js";import{T as L}from"./index-Bre9T0-e.js";import{i as m,u as P}from"./index-BhvR20cr.js";import"./index-Cl9ayPRv.js";import"./index-CouqIJUX.js";import"./index-Cz_0cKVJ.js";import"./iconBase-ViZ73mvc.js";function M({showModal:i,onHideModal:a,project:d,onSuccess:l}){const r=o.useRef(null),t=C(),s=u=>{u.preventDefault(),r.current&&t.submit(r.current,{method:"POST"})},c=o.useCallback(()=>{t.data&&(m(t.data)||(a&&a(),l(),t.data=void 0))},[a,l,t]);return o.useEffect(()=>{c()},[c]),e.jsx(g,{showModal:i,onHideModal:a,title:"Create Test Suite",buttons:[{children:e.jsxs(e.Fragment,{children:[e.jsx(E,{}),"Create"]}),color:"primary",onClick:s,loading:t.state!=="idle"}],children:e.jsxs(t.Form,{action:"../suites/create",method:"POST",ref:r,children:[e.jsxs("p",{className:"text-sm mb-4",children:["Most Betty Blocks applications are secured with"," ",e.jsx("b",{children:"Role Based Access Control"}),". Therefore, the test suites you create should be based on the roles in your application."]}),m(t.data)&&e.jsx(w,{message:t.data.error.message,color:"error"}),e.jsx("input",{type:"hidden",name:"project",value:d.name}),e.jsx(L,{name:"name",disabled:t.state!=="idle",className:"w-full",placeholder:"E.g: Admin",required:!0})]})})}function O({suite:i,project:a,showModal:d,onSuccess:l,onHideModal:r}){const t=o.useRef(null),s=C(),c=h=>{h.preventDefault(),t.current&&s.submit(t.current,{method:"DELETE",action:`/projects/${a.name}/suites/delete`})},u=o.useCallback(()=>{if(s.data){if(m(s.data))return;r&&r(),l(),s.data=void 0}},[r,l,s]);return o.useEffect(()=>{u()},[u]),e.jsxs(g,{showModal:d,onHideModal:r,title:"Are you sure?",buttons:[{children:e.jsxs(e.Fragment,{children:[e.jsx(b,{}),"Confirm"]}),color:"error",onClick:c,loading:s.state!=="idle"}],children:[e.jsxs("p",{className:"text-sm",children:["Are you sure you want to delete test suite ",e.jsx("b",{children:i}),"?"]}),m(s.data)&&e.jsx(w,{message:s.data.error.message,className:"mt-2",color:"error"}),e.jsx(s.Form,{ref:t,children:e.jsx("input",{type:"hidden",name:"suite",value:i})})]})}function _(){const{project:i}=R(),{suites:a}=k(),d=f=>f.map(n=>{var j,S;return{title:n.name,icon:B,status:{ariaLabel:P((j=n.results)==null?void 0:j.status),color:((S=n.results)==null?void 0:S.status)==="passed"?"success":"error"},statusPosition:"start",buttons:[{icon:b,onClick:F,color:"error","data-suite":n.name},{icon:A,href:`/projects/${i.name}/suites/${n.name}/view`}]}}),[l,r]=o.useState(!1),t=()=>{r(!0)},s=()=>{r(!1)},[c,u]=o.useState(""),[h,p]=o.useState(!1),F=f=>{const{dataset:n}=f.currentTarget;n.suite&&(u(n.suite),p(!0))},x=()=>{p(!1)};return e.jsxs("div",{className:"w-full h-screen",children:[e.jsx(M,{project:i,showModal:l,onHideModal:s,onSuccess:s}),e.jsx(O,{suite:c,project:i,showModal:h,onSuccess:x,onHideModal:x}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsx(T,{size:"h1",children:"Test Suites"}),e.jsx("div",{className:"flex flex-row gap-2",children:e.jsx(D,{type:"project"})})]}),e.jsxs(v,{className:"w-full",children:[e.jsx(T,{size:"h5",className:"mb-4",children:"Your Test Suites"}),e.jsx(N,{items:d(a),title:`${a.length} tests suites found`,noResultsText:"No tests suites found",button:e.jsx(y,{onClick:t,type:"button",children:"Create New Suite"})})]})]})]})}export{_ as default};
